<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Simple Math Problem Generator</title>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vue"></script>
    <style>
        body{
            font-family: "Source Sans Pro", "Helvetica Neue", Arial, sans-serif;
        }

        label{
            font-size: 12px;
        }

        input{
            width: 40px;
        }

        .container ul{
            padding: 0;
        }

        .container li{
            display: inline-block;
            width: 300px;
            padding: 4px;
        }

        .question{
            display: inline-block;
        }

        .index{
            display: inline-block;
            width: 50px;
        }


        .question-body{
            display: inline-block;
        }

        .answer{
            display: inline-block;
            width: 50px;
        }

        .token{
            display: inline-block;
            width: 26px;
            white-space: pre;

        }
    </style>
</head>
<body>
    <div id="app" class="container">
        <div>
            <h3>Simple Math Problem Generator / 简易数学题生成器 - jinweijie[AT]gmail.com</h3>
        </div>
        <div>
            <label>Min / 最小值:</label>
            <input type="text" v-model="min" />
            
            <label>Max / 最大值:</label>
            <input type="text" v-model="max" />

            <label>Problem Number / 题目数:</label>
            <input type="text" v-model="problemCount" />

            <label>Two Numbers / 两个数加减:</label>
            <input type="checkbox" v-model="twoNumber" />

            <label>Three Numbers / 三个数加减:</label>
            <input type="checkbox" v-model="threeNumber" />

            <button v-on:click="generate()">Generate / 生成</button>
        </div>
        <div>
            <ul>
                <li v-for="(item, i) in items">
                        <div class="question">
                            <span class="index">({{i + 1}})</span>
                            <span class="question-body" v-for="(token, j) in item"><span class="answer" v-if="token == CONSTS.ANSWER_PH">{{token}}</span><span class="token" v-if="token != CONSTS.ANSWER_PH">{{token}}</span></span>
                        </div>
                </li>
            </ul>
        </div>
        
    </div>

    <script>
        var app = new Vue({
            el: '#app',
            data: {
                CONSTS :{
                    ANSWER_PH : '[ 　 ]'
                },
                min: 0,
                max: 10,
                problemCount: 30,
                twoNumber: true,
                threeNumber: false,
                items : []//this.genPlus1(0, 10) //[['1','+','1','=','2'],]
            },
            methods:{
                pickRandom: function(a, n){
                    this.shuffle(a);
                    return a.slice(0, n);
                },
                shuffle: function(a) {
                    for (let i = a.length; i; i--) {
                        let j = Math.floor(Math.random() * i);
                        [a[i - 1], a[j]] = [a[j], a[i - 1]];
                    }
                },
                // 1 + 1 = [ ]
                genPlus_2_1: function(min, max){
                    var result = [];
                    
                    for(var i = min; i <= max; i++){
                        for(var j = min; j <= max; j++){
                            if( i + j > max )
                                continue;
                            
                            result.push( [i, '+', j, '=', this.CONSTS.ANSWER_PH ]);
                        }                
                    }

                    return result;
                },
                // 1 + [] = 2
                genPlus_2_2: function(min, max){
                    var result = [];
                    
                    for(var i = min; i <= max; i++){
                        for(var j = min; j <= max; j++){
                            if( j > i )
                                continue;
                            
                            result.push( [i, '+', this.CONSTS.ANSWER_PH , '=', j]);
                        }                
                    }

                    return result;
                },
                // [] + 1 = 2
                genPlus_2_3: function(min, max){
                    var result = [];
                    
                    for(var i = min; i <= max; i++){
                        for(var j = min; j <= max; j++){
                            if( j > i )
                                continue;
                            
                            result.push( [this.CONSTS.ANSWER_PH, '+', i, '=', j]);
                        }                
                    }

                    return result;
                },
                // 2 - 1 = []
                genMinus_2_1: function(min, max){
                    var result = [];
            
                    for(var i = max; i >= min; i--){
                        for(var j = max; j >= min; j--){
                            if( i - j < 0 )
                                continue;
                            
                            result.push( [i, '-', j, '=', this.CONSTS.ANSWER_PH]);
                        }                
                    }

                    return result;
                },
                // 2 - [] = 1
                genMinus_2_2: function(min, max){
                    var result = [];
            
                    for(var i = max; i >= min; i--){
                        for(var j = max; j >= min; j--){
                            if( i - j < 0 )
                                continue;
                            
                            result.push( [i, '-',this.CONSTS.ANSWER_PH , '=', j]);
                        }                
                    }

                    return result;
                },
                // [] - 2 = 1
                genMinus_2_3: function(min, max){
                    var result = [];
            
                    for(var i = max; i >= min; i--){
                        for(var j = max; j >= min; j--){
                            if( i + j > max )
                                continue;
                            
                            result.push( [this.CONSTS.ANSWER_PH, '-',i , '=', j]);
                        }                
                    }

                    return result;
                },
                // 1 + 1 + 1= [ ]
                genMix_3_1: function(min, max){
                    var result = [];
                    
                    for(var i = min; i <= max; i++){
                        for(var j = min; j <= max; j++){
                            for(var k = min; k <= max; k++){
                                if( i + j + k <= max ){
                                    result.push( [i, '+', j, '+', k, '=', this.CONSTS.ANSWER_PH ]);
                                }
                                else if(i + j <= max && i + j - k <= max && i + j - k >= 0){
                                    result.push( [i, '+', j, '-', k, '=', this.CONSTS.ANSWER_PH ]);
                                }
                                else if(i + k <= max && i - j + k <= max && i - j >= 0){
                                    result.push( [i, '-', j, '+', k, '=', this.CONSTS.ANSWER_PH ]);
                                }
                                else if(i - j - k >= 0){
                                    result.push( [i, '-', j, '-', k, '=', this.CONSTS.ANSWER_PH ]);
                                }
                                    
                                
                            }
                        }                
                    }

                    return result;
                },
                generate: function(){
                    var total = [];

                    if( this.twoNumber ){ 
                        var plus_2_1 = this.genPlus_2_1(this.min, this.max);
                        var plus_2_2 = this.genPlus_2_2(this.min, this.max);
                        var plus_2_3 = this.genPlus_2_3(this.min, this.max);

                        var minus_2_1 = this.genMinus_2_1(this.min, this.max);
                        var minus_2_2 = this.genMinus_2_2(this.min, this.max);
                        var minus_2_3 = this.genMinus_2_3(this.min, this.max);
                        
                        var total = total.concat(plus_2_1, plus_2_2, plus_2_3,minus_2_1, minus_2_2, minus_2_3, mix_3_1 );
                    }

                    if( this.threeNumber ){
                        var mix_3_1 = this.genMix_3_1(this.min, this.max);
                        var total = total.concat(mix_3_1);
                    }


                    this.items = this.pickRandom(total, this.problemCount);
                }
            },
            created: function(){
                this.generate();
            }
        });

    </script>   
</body>
</html>